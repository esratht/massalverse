<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mars Vurucu Sözleşmesi</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Orbitron:wght@500;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="shadow.css"> 
    <style>
        /* Mars Özel Stili (Kırmızı/Siyah) */
        body { 
            background-color: #050000; color: #ff4500; 
            display: flex; justify-content: center; align-items: center; 
        }
        .container { 
            width: 95%; max-width: 600px; 
            min-height: 80vh; 
            display: flex; flex-direction: column; 
            justify-content: center; 
        }
        /* Ekran Yönetimi */
        .screen { 
            display: none; 
            flex-direction: column; 
            padding: 40px 20px; 
            border: 2px solid #ff4500; 
            background: rgba(50, 0, 0, 0.2); 
            text-align: center;
        }
        .screen.active { display: flex; }

        .contract-box h1, .welcome-screen h1 { 
            font-family: 'Orbitron'; color: #fff; margin-bottom: 20px; 
            text-shadow: 0 0 10px rgba(255, 69, 0, 0.5);
        }
        .contract-box p, .welcome-screen p { 
            font-family: 'Fira Code'; font-size: 0.9rem; line-height: 1.6; margin-bottom: 15px; 
            color: #ccc;
        }
        
        /* Butonlar */
        .unit-display { font-size: 1.2rem; font-weight: bold; color: #00f3ff; margin: 20px 0; }
        .btn-mars { background: #ff4500; color: #000; padding: 15px 30px; font-weight: bold; cursor: pointer; border: none; }
        .btn-mars:hover { background: #fff; box-shadow: 0 0 10px #ff4500; }
        
        .btn-outline { 
            background: transparent; border: 1px solid #555; color: #555; 
            padding: 10px 20px; margin-top: 10px; cursor: pointer; border: none;
        }
        .btn-outline:hover { color: #fff; border-color: #fff; }

        .btn-back { margin-top: 20px; background: transparent; border: 1px solid #555; color: #555; padding: 10px 20px; text-decoration: none; display: block; }
        .btn-back:hover { color: #fff; border-color: #fff; }
        
        .action-container { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="scan-lines"></div>

    <div class="container">
        <div id="welcome-screen" class="screen active">
            <h1>MARS VURUCU SÖZLEŞMESİ</h1>
            <p style="color: #ff4500;">**PROTOKOL BİLGİLENDİRMESİ**</p>
            
            <p>Bu modül, simülasyondaki en kritik eylemi tetikler: **Gölge İle Yüzleşme**. Mars, astrolojik olarak eylemi, savaşı ve enerjiyi temsil eder.</p>
            
            <p>Sözleşme, sana **7 günlük bir eylem döngüsü** sunar. Amacın: **Kâr/Sürdürülebilirlik** metriklerini yükseltmek ve atalet virüsünden kurtulmaktır.</p>
            
            <p>Her Gün Eylem Kaydı yaptığında bir **Eylem Birimi (AU)** kazanırsın. Bu birimler, Ma'nın rehberliğinde büyük kararlar alman için gereken irade gücünü temsil eder.</p>
            
            <p>Sözleşmeyi imzalamak, 7 gün boyunca her gün *bir eylem* yapmayı ve Mars'ın gücünü kullanmayı kabul etmek demektir. Vazgeçmek, birikimini sıfırlar.</p>
            
            <div class="action-container">
                <button class="btn btn-mars" onclick="switchScreen('contract-screen')">SÖZLEŞMEYİ İMZALA VE BAŞLAT</button>
                <a href="../index.html" class="btn-outline">ANA MENÜYE DÖN</a>
            </div>
        </div>

        <div id="contract-screen" class="screen">
            <div class="contract-box" style="border: none; background: none;">
                <a href="../index.html" class="btn-back"> &lt; ANA MENÜYE DÖN</a>
                <h1>MARS EYLEM TAKİBİ</h1>
                <p>Kâr/Sürdürülebilirlik metriğin, Mars'ın eylemiyle yükseliyor.</p>
                
                <p id="contract-status" class="unit-display">Durum Yükleniyor...</p>
                
                <div class="action-container">
                    <button class="btn btn-mars" onclick="performMarsActionAndDisplay()">EYLEMİ KAYDET</button>
                    <button class="btn btn-outline" onclick="resetContract()">SÖZLEŞMEYİ SIFIRLA (DİKKAT! Tüm Birimler Silinir)</button>
                </div>
            </div>
        </div>
    </div>

    <script src="mars.js"></script>
    <script>
        // Ekran Geçiş Fonksiyonu
        function switchScreen(id) {
            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('contract-screen').style.display = 'none';
            document.getElementById(id).style.display = 'flex';
            
            if (id === 'contract-screen') {
                displayInitialStatus();
            }
        }
        
        function performMarsActionAndDisplay() {
            // CRITICAL CHECK: mars.js'in yüklenip yüklenmediğini kontrol et
            if (typeof performMarsAction === 'undefined') {
                alert("HATA: Eylem motoru (mars.js) yüklenemedi. Dosya adını ve yolunu kontrol edin!");
                return;
            }

            const result = performMarsAction();
            const statusElement = document.getElementById('contract-status');
            const status = getContractStatus(); // Güncel durumu tekrar çek (mars.js'den)

            statusElement.innerHTML = `<span style="color: ${result.status === 'error' ? 'red' : '#00f3ff'};">${result.message}</span><br>Toplam Birim: ${status.unitCount}`;
        }

        function resetContract() {
            if (typeof getContractStatus === 'undefined') {
                 alert("HATA: Eylem motoru (mars.js) yüklenemedi. Sıfırlama yapılamıyor.");
                 return;
            }

            if(confirm("DİKKAT! Tüm Mars Eylem Birimlerin ve sözleşme ilerlemen sıfırlanacak. Onaylıyor musun?")) {
                localStorage.removeItem('marsContract');
                displayInitialStatus();
                alert("Sözleşme sıfırlandı. Yeni Mars döngün başladı.");
                switchScreen('welcome-screen'); // Sıfırlayınca karşılama ekranına dön
            }
        }

        function displayInitialStatus() {
            if (typeof getContractStatus === 'undefined') return;
            
            const status = getContractStatus();
            const statusElement = document.getElementById('contract-status');
            statusElement.innerHTML = `
                Mevcut Durum: ${status.day - 1}/${TOTAL_DAYS} Gün.<br>
                **Toplam Eylem Birimi (AU): ${status.unitCount}**
            `;
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // CRITICAL CHECK: Başlangıçta mars.js'in varlığını kontrol et
            if (typeof getContractStatus === 'undefined') {
                 console.error("KRİTİK HATA: mars.js yüklenemedi. Modül devre dışı.");
                 alert("KRİTİK HATA: Mars motoru yüklenemedi. Lütfen 'mars.js' dosyasını kontrol edin.");
                 return;
            }

            const status = getContractStatus();
            // Sözleşme başlamışsa direkt takip ekranına geç
            if (status.unitCount > 0) {
                 switchScreen('contract-screen');
            } else {
                 // Henüz başlamamışsa karşılama ekranını göster (Varsayılan olarak aktif)
                 document.getElementById('welcome-screen').classList.add('active');
            }
        });
    </script>
</body>
</html>